"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],r=!0,o=!1,s=void 0;try{for(var i,n=e[Symbol.iterator]();!(r=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){o=!0,s=e}finally{try{r||null==n.return||n.return()}finally{if(o)throw s}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var selectedColor,interval,form=document.getElementById("form"),divColors=document.getElementById("div-colors"),containerTasks=document.getElementById("container-tasks"),containerMessages=document.getElementById("container-messages"),messagesParagraph=document.getElementById("messages-paragraph"),inputDate=document.getElementById("input-date"),ids=[],arrayTasks=[],arrayMessages=[],generateId=function e(){var t=Math.random().toString(16).substr(2);return void 0===ids.find((function(e){return e===t}))?ids.push(t):e(),t},addZero=function(e){return e.toString().padStart(2,"00")},restrictDate=function(){var e=_slicedToArray((new Date).toLocaleString().split(" "),2),t=e[0],a=e[1],r=_slicedToArray(t.split("/"),3),o=r[0],s=r[1],i=r[2],n=_slicedToArray(a.split(":"),2),l=n[0],c=n[1];return"".concat(i,"-").concat(addZero(s),"-").concat(addZero(o),"T").concat(l,":").concat(c)};inputDate.setAttribute("min",restrictDate());var compareDates=function(e){return e<restrictDate()},validateTaskData=function(e,t){var a=!0;return""===e?(arrayMessages.push("Tarea titulo requerido"),form.input_task.focus(),a=!1):e.length>40?(arrayMessages.push("De [1-40] caracteres, actuales ".concat(e.length)),form.input_task.focus(),a=!1):null==selectedColor||""===selectedColor?(arrayMessages.push("Tarea color requerido"),a=!1):""===t?(arrayMessages.push("Tarea fecha requerida"),form.input_date.focus(),a=!1):!0===compareDates(t)&&(arrayMessages.push("Fecha menor a la actual"),form.input_date.focus(),a=!1),arrayMessages.length>0&&(containerMessages.classList.add("container-messages-visible"),messagesParagraph.textContent="",messagesParagraph.innerHTML=arrayMessages.join(", "),a=!1),a},createTask=function(e,t,a,r,o){var s={id:e,title:t,registrationDate:a,completionDate:r,bgcolor:o,completed:!1};return arrayTasks.unshift(s),s},timeRemaning=function(e){var t=new Date,a=(new Date(e)-t+1e3)/1e3;return{fullTimeRemaning:a,secondsRemaning:"0".concat(Math.floor(a%60)).slice(-2),minutesRemaning:"0".concat(Math.floor(a/60%60)).slice(-2),hoursRemaning:"0".concat(Math.floor(a/3600%24)).slice(-2),daysRemaning:"0".concat(Math.floor(a/86400)).slice(-2),yearsRemaning:Math.floor(a/31536e3)}},showCountDown=function(){arrayTasks.length<=0?clearInterval(interval):document.querySelectorAll("[data-taskCompletionDate]").forEach((function(e){var t=e.getAttribute("data-taskCompletionDate"),a=timeRemaning(t);a.fullTimeRemaning<=0?e.textContent="Time Ended!!":e.textContent="".concat(a.daysRemaning," ").concat(a.hoursRemaning," ").concat(a.minutesRemaning," ").concat(a.secondsRemaning)}))},showTasks=function(){interval=setInterval(showCountDown,1e3),containerTasks.innerHTML="",null===(arrayTasks=JSON.parse(localStorage.getItem("tasks")))?arrayTasks=[]:arrayTasks.forEach((function(e){var t;t=e.completed?"line-through":"",containerTasks.innerHTML+='\n        <div class="container-tasks__item" style="background-color: '.concat(e.bgcolor,'">\n          <div class="container-tasks__item__div-span">\n            <span class="container-tasks__item__div-span__span ').concat(t,'" id="span-title" data-id=').concat(e.id,">").concat(e.title,'</span>\n          </div>\n\n          <div class="container-tasks__item__div-register-date">\n            <label class="container-tasks__item__div-register-date__register">Inicio: ').concat(e.registrationDate,'</label>\n          </div>\n\n          <div class="container-tasks__item__div-completion-date">\n            <label class="container-tasks__item__div-completion-date__completion">Fin: ').concat(e.completionDate,'</label>\n          </div>\n\n          <div class="container-tasks__item__div-count-down-label">\n            <label class="container-tasks__item__div-count-down-label__label">D H M S</label>\n          </div>\n\n          <div class="container-tasks__item__div-count-down-data">\n            <label class="container-tasks__item__div-count-down-data__data" data-taskCompletionDate=').concat(e.completionDate,'></label>\n          </div>\n\n          <div class="container-tasks__item__div-modificar">\n            <label class="container-tasks__item__div-modificar__label-modificar" data-id=').concat(e.id,'>ัด</label>\n          </div>\n\n          <div class="container-tasks__item__div-borrar">\n            <label class="container-tasks__item__div-borrar__label-borrar" data-id=').concat(e.id,">X</label>\n          </div>\n        </div>\n      ")}))},saveLocalStorage=function(){localStorage.setItem("tasks",JSON.stringify(arrayTasks)),arrayMessages=[],messagesParagraph.textContent="",selectedColor="",divColors.firstElementChild.classList.remove("container-form__form__div-colors__html-div1-active"),divColors.children[1].classList.remove("container-form__form__div-colors__html-div2-active"),divColors.lastElementChild.classList.remove("container-form__form__div-colors__html-div3-active"),containerMessages.classList.remove("container-messages-visible"),showTasks()},deleteTask=function(e){var t=arrayTasks.findIndex((function(t){return t.id===e}));arrayTasks.splice(t,1),saveLocalStorage()},completedTask=function(e){var t=arrayTasks.findIndex((function(t){return t.id===e}));arrayTasks[t].completed=!arrayTasks[t].completed,saveLocalStorage()},updateTask=function(e){if("update"===form.input_submit.dataset.action){divColors.firstElementChild.classList.remove("container-form__form__div-colors__html-div1-active"),divColors.children[1].classList.remove("container-form__form__div-colors__html-div2-active"),divColors.lastElementChild.classList.remove("container-form__form__div-colors__html-div3-active");var t=arrayTasks.findIndex((function(t){return t.id===e})),a=arrayTasks[t],r=a.title,o=a.completionDate,s=a.bgcolor;form.input_task.value=r,form.input_date.value=o,"#008000"===(selectedColor=s)?divColors.firstElementChild.classList.add("container-form__form__div-colors__html-div1-active"):"#ff4500"===selectedColor?divColors.children[1].classList.add("container-form__form__div-colors__html-div2-active"):"#ff0000"===selectedColor&&divColors.lastElementChild.classList.add("container-form__form__div-colors__html-div3-active"),form.addEventListener("submit",(function(e){e.preventDefault(),arrayMessages=[];var a=form.input_task.value,r=form.input_date.value;validateTaskData(a,r)&&(arrayTasks[t].title=form.input_task.value,arrayTasks[t].completionDate=form.input_date.value,arrayTasks[t].registrationDate=restrictDate(),arrayTasks[t].bgcolor=selectedColor,saveLocalStorage(),form.reset(),form.input_submit.value="+",form.input_submit.dataset.action="add",window.location.reload())}))}};document.addEventListener("DOMContentLoaded",(function(){showTasks()})),form.input_task.focus(),divColors.addEventListener("click",(function(e){switch(e.preventDefault(),e.target.classList[1]){case"div1":selectedColor="#008000",divColors.firstElementChild.classList.toggle("container-form__form__div-colors__html-div1-active"),divColors.children[1].classList.remove("container-form__form__div-colors__html-div2-active"),divColors.lastElementChild.classList.remove("container-form__form__div-colors__html-div3-active");break;case"div2":selectedColor="#ff4500",divColors.children[1].classList.toggle("container-form__form__div-colors__html-div2-active"),divColors.firstElementChild.classList.remove("container-form__form__div-colors__html-div1-active"),divColors.lastElementChild.classList.remove("container-form__form__div-colors__html-div3-active");break;case"div3":selectedColor="#ff0000",divColors.lastElementChild.classList.toggle("container-form__form__div-colors__html-div3-active"),divColors.firstElementChild.classList.remove("container-form__form__div-colors__html-div1-active"),divColors.children[1].classList.remove("container-form__form__div-colors__html-div2-active");break;case void 0:arrayMessages.push("Color de tarea indefinido");break;case null:arrayMessages.push("Color de tarea null");break;default:arrayMessages.push("Color de tarea requerido")}})),form.addEventListener("submit",(function(e){if(e.preventDefault(),"add"===form.input_submit.dataset.action){arrayMessages=[];var t=generateId(),a=restrictDate(),r=form.input_task.value,o=form.input_date.value;if(validateTaskData(r,o)){var s=form.input_task.value;form.input_task.value="";var i=form.input_date.value;createTask(t,s,a,i,selectedColor),saveLocalStorage()}}})),containerTasks.addEventListener("click",(function(e){if(e.preventDefault(),"X"===e.target.innerHTML){var t=e.target.getAttribute("data-id");deleteTask(t)}else if("ัด"===e.target.innerHTML){var a=e.target.getAttribute("data-id");completedTask(a)}if(e.target.matches("#span-title")){var r=e.target.getAttribute("data-id");form.input_submit.value="U",form.input_submit.dataset.action="update",updateTask(r)}}));